<div class = "page">
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<div class="container">
  <div class="search-section">
    <div class="search-container">
      <i class="fas fa-book fa-lg"></i>
      <input type="text"
             [formControl]="myControlTitles"
             placeholder="Search for books by title...."
             class="search-bar"
             (blur)="onBlurTitle()"
             (focus)="isBlurredTitle = false"
             (keydown.enter)="selectTitle(myControlTitles.value)">
      <div class="autocomplete-items"
           *ngIf="myControlTitles.value && filteredTitles.length && !isBlurredTitle">
        <div *ngFor="let title of filteredTitles"
             (click)="selectTitle(title); isBlurredTitle = true"
             [class.active]="selectedTitle === title">
          {{ title }}
        </div>
      </div>
    </div>
    <div class="search-container">
      <i class="fas fa-award fa-lg"></i>
      <input type="text"
             [formControl]="myControlAwards"
             placeholder="Search for books by award...."
             class="search-bar"
             (blur)="onBlurAward()"
             (focus)="isBlurredAward = false"
             (keydown.enter)="selectAward(myControlAwards.value)">
      <div class="autocomplete-items"
           *ngIf="myControlAwards.value && filteredAwards.length && !isBlurredAward">
        <div *ngFor="let award of filteredAwards"
             (click)="selectAward(award); isBlurredAward = true"
             [class.active]="selectedAward === award">
          {{ award }}
        </div>
      </div>
    </div>
    <div class="search-container">
      <i class="fas fa-user fa-lg"></i>
      <input type="text"
             [formControl]="myControl"
             placeholder="Search for books by author...."
             class="search-bar"
             (blur)="onBlurAuthor()"
             (focus)="isBlurredAuthor = false"
             (keydown.enter)="selectAuthor(myControl.value)">
      <div class="autocomplete-items"
           *ngIf="myControl.value && filteredAuthors.length && !isBlurredAuthor">
        <div *ngFor="let author of filteredAuthors"
             (click)="selectAuthor(author); isBlurredAuthor = true"
             [class.active]="selectedAuthor === author">
          {{ author }}
        </div>
      </div>
    </div>
  </div>
  <div class="search-section">
    <div class="search-item">
        <i class="fas fa-theater-masks fa-lg"></i>
        <select [(ngModel)]="selectedGenre" (change)="selectGenre()" class="filter-input">
            <option value="" disabled selected>Select a genre...</option>
            <option value="No Genre Selected">No Genre Selected</option>
            <option *ngFor="let genre of genres">{{ genre }}</option>
        </select>
    </div>
    <div class="search-item">
        <i class="fas fa-child fa-lg"></i>
        <select [(ngModel)]="filterAge" (change)="filterBooksByAge()" class="filter-input">
            <option value="" disabled>Select an age range...</option>
            <option value="No Age Selected">No Age Selected</option>
            <option *ngFor="let ageRange of ageRanges">{{ ageRange }}</option>
        </select>
    </div>
    <div class="search-item">
        <i class="fas fa-language fa-lg"></i>
        <select [(ngModel)]="selectedLanguage" (change)="filterLanguage()" class="filter-input">
            <option value="" disabled>Select an language...</option>
            <option value="No Language Selected">No Language Selected</option>
            <option *ngFor="let language of languages">{{ language }}</option>
        </select>
    </div>
</div>
  <div class="book-list">
    <div *ngFor="let book of books" class="book-card">
      <h2 class="book-title" (click)="onBookTitleClick(book.title, book.authors[0])">{{ book.title }}</h2>
      <p>
        <i class="fas fa-user"></i>
        <ng-container *ngFor="let author of book.authors; let i = index">
          <span (click)="navigateToAuthor(author)">{{ author }}</span>
          <span *ngIf="i < book.authors.length - 1">, </span>
          <span *ngIf="i === book.authors.length - 1">&nbsp;</span>
        </ng-container>
      </p>
      <p>
        <i class="fas fa-building"></i> {{ book.publisher }}
      </p>
      <p>
        <i class="fas fa-globe"></i> {{ book.inLanguage }}
      </p>
      <div class="award-section" *ngFor="let award of book.awards">
        <p class="award-name" (click)= "navigateToAward(award.name)">
          <i class="fas fa-trophy"></i> {{ award.name }} ({{ award.year }})
        </p>
        <p>
          <strong>Genre:</strong> {{ award.genre }}
        </p>
        <p *ngIf="award.ageRange && award.ageRange.length > 0">
          <strong>Age:</strong> {{ award.ageRange.join(', ') }}
        </p>
      </div>
    </div>
  </div>
</div>
</div>
