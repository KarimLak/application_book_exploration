<div class = "page">
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<div class="container">
  <div class="search-section">
    <div class="search-container">
      <i class="fas fa-book fa-lg"></i>
      <input type="text"
             [formControl]="myControlTitles"
             placeholder="Recherchez un livre par son titre..."
             class="search-bar"
             (blur)="onBlurTitle()"
             (focus)="isBlurredTitle = false"
             (keydown.enter)="selectTitle(myControlTitles.value)">
      <div class="autocomplete-items"
           *ngIf="myControlTitles.value && filteredTitles.length && !isBlurredTitle">
        <div *ngFor="let title of filteredTitles"
             (click)="selectTitle(title); isBlurredTitle = true"
             [class.active]="selectedTitle === title">
          {{ title }}
        </div>
      </div>
    </div>
    <div class="search-container">
      <i class="fas fa-award fa-lg"></i>
      <input type="text"
             [formControl]="myControlAwards"
             placeholder="Recherchez un livre par son prix..."
             class="search-bar"
             (blur)="onBlurAward()"
             (focus)="isBlurredAward = false"
             (keydown.enter)="selectAward(myControlAwards.value)">
      <div class="autocomplete-items"
           *ngIf="myControlAwards.value && filteredAwards.length && !isBlurredAward">
        <div *ngFor="let award of filteredAwards"
             (click)="selectAward(award); isBlurredAward = true"
             [class.active]="selectedAward === award">
          {{ award }}
        </div>
      </div>
    </div>
    <div class="search-container">
      <i class="fas fa-user fa-lg"></i>
      <input type="text"
             [formControl]="myControl"
             placeholder="Recherchez un livre par son auteur..."
             class="search-bar"
             (blur)="onBlurAuthor()"
             (focus)="isBlurredAuthor = false"
             (keydown.enter)="selectAuthor(myControl.value)">
      <div class="autocomplete-items"
           *ngIf="myControl.value && filteredAuthors.length && !isBlurredAuthor">
        <div *ngFor="let author of filteredAuthors"
             (click)="selectAuthor(author); isBlurredAuthor = true"
             [class.active]="selectedAuthor === author">
          {{ author }}
        </div>
      </div>
    </div>
  </div>
  <div class="search-section">
    <div class="search-item">
        <i class="fas fa-theater-masks fa-lg"></i>
        <select [(ngModel)]="selectedGenre" (change)="selectGenre()" class="filter-input">
            <option value="" disabled selected>Selectionnez un genre...</option>
            <option value="Aucun genre sélectionné">Aucun genre sélectionné</option>
            <option *ngFor="let genre of genres">{{ genre }}</option>
        </select>
    </div>
    <div class="search-item">
        <i class="fas fa-child fa-lg"></i>
        <select [(ngModel)]="filterAge" (change)="filterBooksByAge()" class="filter-input">
            <option value="" disabled>Selectionnez un age...</option>
            <option value="Aucun age sélectionné">Aucun age sélectionné</option>
            <option *ngFor="let ageRange of ageRanges">{{ ageRange }}</option>
        </select>
    </div>
    <div class="search-item">
        <i class="fas fa-language fa-lg"></i>
        <select [(ngModel)]="selectedLanguage" (change)="filterLanguage()" class="filter-input">
            <option value="" disabled>Selectionnez une langue...</option>
            <option value="Aucune langue sélectionnée">Aucune langue sélectionnée</option>
            <option *ngFor="let language of languages">{{ language }}</option>
        </select>
    </div>
</div>
<div class="book-list">
  <div *ngFor="let book of books" class="book-card">
    <h2 class="book-title" (click)="navigateToBook(book)">{{ book.title }}</h2>
    <p>
      <i class="fas fa-user"></i>
      <ng-container *ngFor="let author of book.authors; let i = index">
        <span (click)="navigateToAuthor(author)">{{ author }}</span>
        <span *ngIf="i < book.authors.length - 1">, </span>
        <span *ngIf="i === book.authors.length - 1">&nbsp;</span>
      </ng-container>
    </p>
    <p *ngIf="book.publisher" (click)="navigateToPublisher(book.publisher)" class="publisher-info">
      <i class="fas fa-building"></i> {{ book.publisher }}
    </p>    
    <p>
      <i class="fas fa-globe"></i> {{ book.inLanguage }}
    </p>
    <p *ngIf="book.illustrator && book.illustrator.length > 0">
      <i class="fas fa-paint-brush"></i>
      <ng-container *ngFor="let illustrator of book.illustrator; let i = index">
        <span (click)="navigateToIllustrator(illustrator)">{{ illustrator }}</span>
        <span *ngIf="i < book.illustrator.length - 1">, </span>
        <span *ngIf="i === book.illustrator.length - 1">&nbsp;</span>
      </ng-container>
    </p>
    <p *ngIf="book.countryOfOrigin">
      <i class="fas fa-flag"></i> {{ book.countryOfOrigin }}
    </p>
    <div class="award-section" *ngFor="let award of book.awards">
      <p class="award-name" (click)= "navigateToAward(award.name)">
        <i class="fas fa-trophy"></i> {{ award.name }} ({{ award.year }})
      </p>
      <p>
        <strong>Genre:</strong> {{ award.genre }}
      </p>
      <p *ngIf="award.ageRange && award.ageRange.length > 0">
        <strong>Age:</strong> {{ award.ageRange.join(', ') }}
      </p>
    </div>
  </div>
</div>
</div>
